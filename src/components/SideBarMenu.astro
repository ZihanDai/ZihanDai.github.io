---
const activeClass = "bg-base-300";
const currentFullPath = Astro.url.pathname;

const normalizePath = (path) => path.replace(/\/+$/, "") || "/";
const currentPath = normalizePath(currentFullPath);

const menuItems = [
    { id: "home", href: "/", label: "Home" },
    { id: "projects", href: "/projects/", label: "Projects" },
    { id: "cv", href: "/documents/resume.pdf", label: "My CV" },
    { id: "awards", href: "/awards", label: "Awards" },
    { id: "blog", href: "/blogs/", label: "Blogs" },
    { id: "contact", href: "mailto:contact.manuelernestog@gmail.com", label: "Contact" },
];

const isActive = (menuPath) => {
  const normalizedMenu = normalizePath(menuPath);
  return normalizedMenu === "/" 
    ? currentPath === "/"
    : currentPath.startsWith(normalizedMenu);
};
---

<ul class="menu grow shrink menu-md overflow-y-auto">
    {
        menuItems.map((item) => (
            <li>
                <a
                    class={`py-3 text-base ${isActive(item.href) ? activeClass : ""}`}
                    id={item.id}
                    href={item.href}
                    target={item.href.startsWith("mailto:") ? "_blank" : undefined}
                    referrerpolicy={item.href.startsWith("mailto:") ? "no-referrer-when-downgrade" : undefined}
                >
                    {item.label}
                </a>
            </li>
        ))
    }
</ul>
